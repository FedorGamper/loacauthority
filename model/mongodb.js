const userRecords = [];
const resourceRecords = [{
    name: "Raspberry pi",
    resourceName: "fedorspi",
    description: "von Fedor",
    buttons: [{
        text: "small Coffee",
        command: "brew small coffee"
    }, {
        text: "large Coffee",
        command: "brew large coffee"
    }],
    imageUrl: "data:image/jpeg;base64,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"
}, {
    name: "Super Raspi",
    resourceName: "gianlucaspi",
    description: "von Gian-Luca",
    imageUrl: "data:image/png;base64,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"
}];

const User = require("./User");
//const Permission = require("./Permission");
const Resource = require("./Resource");
const mongoose = require('mongoose');

const Schema = mongoose.Schema;

/* Database:
        loac{
            resouces: Resource Records,
            users: User Records
 */
const dbUsername = "LoacAdmin";
const pw = "pnxr2lmBzx0JFRjS";
const url = "mongodb+srv://" + dbUsername + ":" + pw + "@loacprotocol-kf4bj.gcp.mongodb.net/loac?retryWrites=true/";

mongoose.connect(url, {useNewUrlParser: true});

mongoose.set('useCreateIndex', true);
mongoose.set('useFindAndModify', false);

const db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB connection error:'));

const ResourceSchema = new Schema({
    name: String,
    resourceName: {type: String, unique: true},
    description: String,
    buttons: [
        {
            text: String,
            command: String
        }
    ],
    imageUrl: String
});
ResourceSchema.loadClass(Resource);
const ResourceModel = mongoose.model("resources", ResourceSchema);

const UserSchema = new Schema({
    isAdmin: Boolean,
    name: String,
    username: {type: String, unique: true},
    password: String,
    permissions: [{type: Schema.Types.Mixed, unique:true}],
    certificate: [Schema.Types.Mixed]

});
UserSchema.loadClass(User);
const UserModel = mongoose.model("users", UserSchema);


class mongo {

    static async findUser(username) {
        return UserModel.findOne({username: username}, (err, user) => {
            if (err) {
                console.log("err: " + err)
            }
            return user;
        });
    }

    static async allUsers() {
        return UserModel.find({}, (err, users) => {
            if (err) {
                console.log("err: " + err)
            }
            return users;
        });
    }

    static async addUser(user) {
        return UserModel.create(user,
            (err, user) => {
                if (err) {
                    console.log("err: " + err)
                }
                return user
            }
        );
    }

    static async addPermission(username, permission) {
        return  UserModel.findOneAndUpdate(
            {username: username},
            {$push: {permissions: permission}},
            { upsert: true, new: true });
    }
    static async addCert(username, cert) {
        return UserModel.findOneAndUpdate(
            {username: username},
            {$push: {certificate: cert}},
            { upsert: true, new: true});
    }
    static async allResources(){
        return ResourceModel.find({},(err, resources)=>{
            if(err) console.log(err);
            return resources;
        });
    }
    static async findResource(resourceName){
        return ResourceModel.findOne({resourceName:resourceName},(err, resource) => {
            if (err) {
                console.log("err: " + err)
            }
            return resource;
        });
    }



}
module.exports = mongo;

/*
(async () => {
    await addUser(new User(false, 'batman', 'test user', '$2b$10$uQu5POudgz/PilxYAldzLuUlUmhBOxYw8nxhIy/eGWNfmJnFo6O6y'))
            .then((user) => console.log("user added: " + user)
            .catch(err => console.log(err)));
    await addPermission("batman" ,new Permission("Fedors Raspi",
        "fedorspi", "von Fedor",
        "data:image/jpeg;base64,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",
        "brew small coffee",
        "brew small coffee",
        {
            "delegable": true,
            "resource": "fedorspi",
            "validityStart": 1555891200,
            "validityEnd": 1556064000,
            "signature": "e5808adb1340e765ebf56629ec24eb9f81a8928aeed21504f8214855221a546da248c63b430cfe2d7f343a95b2391ede01"
        })).then(res => console.log("add Permission res: " + res))
        .catch(err=>console.log(err));
    await findUser("batman")
        .then((users) => console.log("user found: " + JSON.stringify(users[0].permissions[0].name)))
        .catch(err=>console.log(err))

})();




class DB {
    static addUser(user) {
        if (!user instanceof User) {
            throw "DB.addUser: user is not an instance of User"
        }
        if (!this.findUserByName(user.username)) {
            userRecords.push(user);
            return true;
        } else {
            throw "DB.addUser: user already exists."
        }

    }

    static addCert(username, cert) {
        let record = this.findUserByName(username.toLowerCase());
        if (!record) {
            throw "DB.addCert: user not found";
        }
        record.certificate.push(cert);
        return true;

    }

    static addPermission(username, permission) {
        let record = this.findUserByName(username.toLowerCase());
        if (!record && !permission instanceof Permission) {
            throw "DB.addPermission: user not found";
        }
        record.permissions.push(permission);
        return true;
    }

    static findUserByName(username) {
        const record = userRecords.filter(r => username.toLowerCase() === r.username)[0];
        return record !== undefined ? record : false;
    }

    static getUsers() {
        return userRecords;
    }

    static addResource(resource) {
        if (!resource instanceof Resource) {
            throw "DB.addResource: resource in not an instance of Resource"
        }
        let record = this.findResourceByName(resource.resourceName.toLowerCase());
        if (!record) {
            throw "DB.addResource: resource already exists"
        }
        resourceRecords.push(resource);
    }

    static async getResources() {
        var result = await find();
        console.log("DB: " + result.length);
        return result;
    }

    static findResourceByName(name) {
        var record = resourceRecords.filter(r => name.toLowerCase() === r.resourceName)[0];
        return record !== undefined ? record : false;
    }

    static getPermissions(username) {
        const record = this.findUserByName(username.toLowerCase());
        if (!record) {
            throw "DB.getPermission: user not found";
        }
        return record.permissions;
    }

}

module.exports = DB;

*/